{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\DELL\\\\Desktop\\\\Questgen\\\\frontend\\\\src\\\\context\\\\AuthContext.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useEffect, useState } from 'react';\nimport { signInWithEmailAndPassword, signOut, onAuthStateChanged, createUserWithEmailAndPassword, sendPasswordResetEmail, getIdToken } from 'firebase/auth';\nimport { auth } from '../services/firebase';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(undefined);\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, async firebaseUser => {\n      if (firebaseUser) {\n        // Convert Firebase user to our User type\n        const userData = {\n          uid: firebaseUser.uid,\n          email: firebaseUser.email || '',\n          display_name: firebaseUser.displayName || '',\n          photo_url: firebaseUser.photoURL || '',\n          role: 'teacher',\n          // Default role, can be updated later\n          created_at: new Date().toISOString(),\n          last_login: new Date().toISOString()\n        };\n        setUser(userData);\n        try {\n          const token = await getIdToken(firebaseUser, true);\n          localStorage.setItem('authToken', token);\n        } catch {\n          localStorage.removeItem('authToken');\n        }\n        setError(null);\n      } else {\n        setUser(null);\n        localStorage.removeItem('authToken');\n        setError(null);\n      }\n      setLoading(false);\n    });\n    return () => unsubscribe();\n  }, []);\n  const signIn = async (email, password) => {\n    try {\n      setLoading(true);\n      setError(null);\n      await signInWithEmailAndPassword(auth, email, password);\n    } catch (err) {\n      const message = (err === null || err === void 0 ? void 0 : err.code) === 'auth/configuration-not-found' ? 'Firebase auth is not configured. Enable Email/Password in Firebase Console and set .env variables.' : err.message || 'Failed to sign in';\n      setError(message);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const signUp = async (email, password, displayName) => {\n    try {\n      setLoading(true);\n      setError(null);\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\n\n      // Update display name\n      if (userCredential.user) {\n        await (await import('firebase/auth')).updateProfile(userCredential.user, {\n          displayName\n        });\n      }\n    } catch (err) {\n      const message = (err === null || err === void 0 ? void 0 : err.code) === 'auth/configuration-not-found' ? 'Firebase auth is not configured. Enable Email/Password in Firebase Console and set .env variables.' : err.message || 'Failed to sign up';\n      setError(message);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const logout = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n      await signOut(auth);\n      setUser(null);\n    } catch (err) {\n      const message = (err === null || err === void 0 ? void 0 : err.code) === 'auth/configuration-not-found' ? 'Firebase auth is not configured.' : err.message || 'Failed to sign out';\n      setError(message);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const resetPassword = async email => {\n    try {\n      setLoading(true);\n      setError(null);\n      await sendPasswordResetEmail(auth, email);\n    } catch (err) {\n      const message = (err === null || err === void 0 ? void 0 : err.code) === 'auth/configuration-not-found' ? 'Firebase auth is not configured. Enable Email/Password and verify .env.' : err.message || 'Failed to send password reset email';\n      setError(message);\n      throw err;\n    } finally {\n      setLoading(false);\n    }\n  };\n  const updateUserProfile = updates => {\n    if (user) {\n      setUser({\n        ...user,\n        ...updates\n      });\n    }\n  };\n  const value = {\n    user,\n    loading,\n    error,\n    signIn,\n    signUp,\n    logout,\n    resetPassword,\n    updateUserProfile\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 153,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"PA9FxEY9xSNRrsSqaLtbYei52Hs=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useState","signInWithEmailAndPassword","signOut","onAuthStateChanged","createUserWithEmailAndPassword","sendPasswordResetEmail","getIdToken","auth","jsxDEV","_jsxDEV","AuthContext","undefined","AuthProvider","children","_s","user","setUser","loading","setLoading","error","setError","unsubscribe","firebaseUser","userData","uid","email","display_name","displayName","photo_url","photoURL","role","created_at","Date","toISOString","last_login","token","localStorage","setItem","removeItem","signIn","password","err","message","code","signUp","userCredential","updateProfile","logout","resetPassword","updateUserProfile","updates","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","context","Error","$RefreshReg$"],"sources":["C:/Users/DELL/Desktop/Questgen/frontend/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useContext, useEffect, useState, ReactNode } from 'react';\r\nimport { \r\n  User as FirebaseUser, \r\n  signInWithEmailAndPassword, \r\n  signOut, \r\n  onAuthStateChanged,\r\n  createUserWithEmailAndPassword,\r\n  sendPasswordResetEmail,\r\n  getIdToken\r\n} from 'firebase/auth';\r\nimport { auth } from '../services/firebase';\r\nimport { User, AuthState } from '../types';\r\n\r\ninterface AuthContextType extends AuthState {\r\n  signIn: (email: string, password: string) => Promise<void>;\r\n  signUp: (email: string, password: string, displayName: string) => Promise<void>;\r\n  logout: () => Promise<void>;\r\n  resetPassword: (email: string) => Promise<void>;\r\n  updateUserProfile: (updates: Partial<User>) => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\ninterface AuthProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport const AuthProvider: React.FC<AuthProviderProps> = ({ children }) => {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    const unsubscribe = onAuthStateChanged(auth, async (firebaseUser: FirebaseUser | null) => {\r\n      if (firebaseUser) {\r\n        // Convert Firebase user to our User type\r\n        const userData: User = {\r\n          uid: firebaseUser.uid,\r\n          email: firebaseUser.email || '',\r\n          display_name: firebaseUser.displayName || '',\r\n          photo_url: firebaseUser.photoURL || '',\r\n          role: 'teacher', // Default role, can be updated later\r\n          created_at: new Date().toISOString(),\r\n          last_login: new Date().toISOString(),\r\n        };\r\n        setUser(userData);\r\n        try {\r\n          const token = await getIdToken(firebaseUser, true);\r\n          localStorage.setItem('authToken', token);\r\n        } catch {\r\n          localStorage.removeItem('authToken');\r\n        }\r\n        setError(null);\r\n      } else {\r\n        setUser(null);\r\n        localStorage.removeItem('authToken');\r\n        setError(null);\r\n      }\r\n      setLoading(false);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, []);\r\n\r\n  const signIn = async (email: string, password: string) => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n    } catch (err: any) {\r\n      const message = err?.code === 'auth/configuration-not-found'\r\n        ? 'Firebase auth is not configured. Enable Email/Password in Firebase Console and set .env variables.'\r\n        : (err.message || 'Failed to sign in');\r\n      setError(message);\r\n      throw err;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const signUp = async (email: string, password: string, displayName: string) => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n      \r\n      // Update display name\r\n      if (userCredential.user) {\r\n        await (await import('firebase/auth')).updateProfile(userCredential.user, { displayName });\r\n      }\r\n    } catch (err: any) {\r\n      const message = err?.code === 'auth/configuration-not-found'\r\n        ? 'Firebase auth is not configured. Enable Email/Password in Firebase Console and set .env variables.'\r\n        : (err.message || 'Failed to sign up');\r\n      setError(message);\r\n      throw err;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      await signOut(auth);\r\n      setUser(null);\r\n    } catch (err: any) {\r\n      const message = err?.code === 'auth/configuration-not-found'\r\n        ? 'Firebase auth is not configured.'\r\n        : (err.message || 'Failed to sign out');\r\n      setError(message);\r\n      throw err;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const resetPassword = async (email: string) => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      await sendPasswordResetEmail(auth, email);\r\n    } catch (err: any) {\r\n      const message = err?.code === 'auth/configuration-not-found'\r\n        ? 'Firebase auth is not configured. Enable Email/Password and verify .env.'\r\n        : (err.message || 'Failed to send password reset email');\r\n      setError(message);\r\n      throw err;\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const updateUserProfile = (updates: Partial<User>) => {\r\n    if (user) {\r\n      setUser({ ...user, ...updates });\r\n    }\r\n  };\r\n\r\n  const value: AuthContextType = {\r\n    user,\r\n    loading,\r\n    error,\r\n    signIn,\r\n    signUp,\r\n    logout,\r\n    resetPassword,\r\n    updateUserProfile,\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={value}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = (): AuthContextType => {\r\n  const context = useContext(AuthContext);\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}